# SuperTueDataCleaner

## Overview
Traffic Count - Bicycle Count - Bike count - Morning Peak 7am to 9am - Weekday - Super ~ 2017.xlsx is a 7.6MB excel spreadsheet containing the results of bicycle counts undertaken by Moreland Council between 2006 and 2017.  The file contains 101 worksheets and is the record of over 600 counts at 95 locations.  Most (but not all) counts were:
 * conducted between 7am and 9am
 * at an intersection
 * recorded turning movements
 * included eight fifteen minute data bins
 * recorded whether the counter thought bike rider was male or female.

The script super_tue_cleaner.py interrogates this excel spreadsheet and saves a .csv file in the directory './script_output/count_observations/' for each count.  
The script super_tue_cleaner.py creates a a summary .csv file containing all the location metadata for each count site recorded within the .xlsx spreadsheet.  This file is saved as './script_output/count_locations/count_location_details.csv'

The jupyter python notebooks 'Super Tuesday Multiple Site Analysis Tool.pynb', generates summary statistics using the .csv files generated by super_tue_cleaner.py and saves the results in the directory './script_output/allsites_summary/'

The jupyter notebook 'map point converter.pynb' uses 'count_location_details.csv' (created by 'super_tue_cleaner.py') and 'allsites_summary/allmovesallriders7to9year.csv' (created by 'Super Tuesday Multiple Site Analysis Tool.pynb') to generate './script_output/count_locations/count_location_details.json'

The json file can be manually copied to https://morelandtransport.github.io/json/count_location_details.json to display the results on a leaflet map at https://morelandtransport.github.io/


'Gender Split by Count year.pynb' and 'Super Tuesday Single Site Data Analysis Tool.pynb' are other investigations using the .csv output files of 'super_tue_cleaner.py'.  The jupyter notebook 'Super Tuesday Single Site Data Analysis Tool.ipynb' and 'Super Tuesday Multiple Site Data Analysis Tool.ipynb' allow for subsetting of the count results to investigate issues such as "growth in female riders" or "frequency of a particular turning movement over time".


## Config
The super_tue_cleaner.py script written in python 2.7.13 and uses xlrd (available from https://pypi.python.org/pypi/xlrd)
.ipynb files uses pandas


## Background
The Moreland Council conducted bicycle surveys between 7am and 9am on a Tuesday in early March between 2006 and 2017.
The methods used for these surveys were similar to the 'Super Tuesday' survey conducted by bicycle network https://www.bicyclenetwork.com.au/general/for-government-and-business/3060/

Data from these serveys and analysis of the results was recorded the excel file 'Traffic Count - Bicycle Count - Bike count - Morning Peak 7am to 9am - Weekday - Super ~ 2017.xlsx'

The script super_tue_cleaner.py performs a scrape of the excel document to create 'clean' tabular data.

Location information for each site including GIS co-ordinates are stored in ./script_output/count_locations/
The Coordinate Reference System used in the orginal excel spreadsheet (and count_location_details.csv is GDA 94 MGA Zone 55 http://spatialreference.org/ref/epsg/gda94-mga-zone-55/


# TODO
### Documentation
* Add a licence to this repo.

### Testing
* Verify all counts included in .xlsx spreadsheet get converted into a .csv file
* Flag errors in the .xlsx file for correction to master copy (then replace local version with copy of master)

### Add functionality
* Create pop up boxes that depict 'change over time' graphs
* Add key bike routes on leafet map with polylines.
* Add "movements along bike route segment" as an attribute to the polyline.
